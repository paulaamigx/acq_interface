{"ast":null,"code":"var _jsxFileName = \"/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js\";\nimport './InferenceUI.css';\nimport { Container, Row, Col } from 'reactstrap';\nimport React from 'react'; //import io from 'socket.io-client';\n\nimport WebcamStream from './WebcamStream.js';\nimport Screenshots from './Screenshots.js';\nimport Diagnosis from './Diagnosis.js';\nimport ElementsMain from './ElementsMain.js';\nimport manageStates from './functions/stateManager.js';\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\n\nclass InferenceUI extends React.Component {\n  constructor(props) {\n    super();\n    this.state = {\n      stateName: \"Idle\",\n      // Render canvas or video\n      renderCanvas: true,\n      // Canvas Message\n      canvasMessage: \"\",\n      canvasAlert: false,\n      // Progress Bar props\n      showProgressBar: false,\n      progress: 0,\n      // Show Spinner\n      showSpinner: false,\n      // Button state\n      textCtrlBtn: \"Empezar\",\n      enableCtrlBtn: false,\n      enableCaptureBtn: false,\n      // Side Panel\n      enableDownloadsTab: false,\n      enableDiagnosisTab: false,\n      enableConfigTab: true,\n      enableGalleryTab: false,\n      GallerySrc: []\n    };\n    this.childScreenshots = React.createRef();\n    this.childWebcamStream = React.createRef();\n    this.childElementsMain = React.createRef();\n    this.childDiagnosis = React.createRef();\n    this.countdownFrom = 1;\n    this.alertTimeout = null;\n    this.videoThumbnail = null;\n  }\n\n  async handler(nextState) {\n    await this.setState({\n      stateName: nextState\n    });\n    console.log(\"estado en switch: \" + this.state.stateName);\n    await this.setState(manageStates(this.state.stateName));\n  }\n\n  captureScreenshot() {\n    this.childScreenshots.current.captureScreenshot();\n  }\n\n  mirrorPreview() {\n    this.childWebcamStream.current.mirror();\n  }\n\n  changeProgress(val) {\n    this.setState({\n      progress: val\n    });\n  }\n\n  openNMAlert() {\n    this.childElementsMain.current.setState({\n      openNMAlert: true\n    }); //      this.childElementsMain.current.stopFunction(); \n  }\n\n  async startRecording() {\n    this.childWebcamStream.current.startRecording();\n  }\n\n  async stopRecording() {\n    await this.childWebcamStream.current.stopRecording();\n  }\n\n  getVideoThumbnail(img) {\n    this.videoThumbnail = img;\n  }\n\n  getScreenshots() {\n    return this.childScreenshots.current.getScreenshots();\n  }\n\n  downloadHandler(media) {\n    if (media.localeCompare(\"video\") === 0) {\n      this.childWebcamStream.current.downloadVideo();\n    } else if (media.localeCompare(\"screenshots\") === 0) {\n      console.log(\"in\");\n      this.childScreenshots.current.download();\n    }\n  }\n\n  changeStateProp(string) {\n    this.setState(string);\n  }\n\n  setScreenshots(data) {\n    this.setState({\n      screenshots: this.state.screenshots.concat(data)\n    });\n  }\n\n  setStream() {\n    this.childWebcamStream.current.setStream();\n  }\n\n  componentDidMount() {\n    this.childDiagnosis.listDevices();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      id: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(WebcamStream, {\n      currentState: this.state,\n      handler: nextState => this.handler(nextState),\n      changeStateProp: string => this.changeStateProp(string),\n      countdownFrom: this.countdownFrom,\n      ref: this.childWebcamStream,\n      getVideoThumbnail: img => this.getVideoThumbnail(img),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Diagnosis, {\n      currentState: this.state,\n      thumbnail: this.videoThumbnail,\n      getScreenshots: () => this.getScreenshots(),\n      downloadHandler: media => this.downloadHandler(media),\n      setStreamFromConfig: () => this.setStream(),\n      ref: this.childDiagnosis,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }\n    }))));\n  }\n\n}\n\nfunction fromServer(el, signal, val) {\n  //element, signal and valuue if necessary\n  if (signal.localeCompare(\"blur\") === 0) {\n    if (el.state.showAlert) {\n      clearTimeout(el.alertTimeout);\n      el.alertTimeout = setTimeout(function () {\n        el.setState({\n          canvasMessage: false\n        });\n      }, 5000);\n    } else {\n      el.setState({\n        canvasMessage: true\n      });\n      el.alertTimeout = setTimeout(function () {\n        el.setState({\n          canvasMessage: false\n        });\n      }, 5000);\n    }\n  } else if (signal.localeCompare(\"progress\") === 0) {\n    el.changeProgress(val);\n  } else if (signal.localeCompare(\"NM\") === 0) {\n    el.openNMAlert();\n  }\n}\n\nexport default InferenceUI;","map":{"version":3,"sources":["/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js"],"names":["Container","Row","Col","React","WebcamStream","Screenshots","Diagnosis","ElementsMain","manageStates","InferenceUI","Component","constructor","props","state","stateName","renderCanvas","canvasMessage","canvasAlert","showProgressBar","progress","showSpinner","textCtrlBtn","enableCtrlBtn","enableCaptureBtn","enableDownloadsTab","enableDiagnosisTab","enableConfigTab","enableGalleryTab","GallerySrc","childScreenshots","createRef","childWebcamStream","childElementsMain","childDiagnosis","countdownFrom","alertTimeout","videoThumbnail","handler","nextState","setState","console","log","captureScreenshot","current","mirrorPreview","mirror","changeProgress","val","openNMAlert","startRecording","stopRecording","getVideoThumbnail","img","getScreenshots","downloadHandler","media","localeCompare","downloadVideo","download","changeStateProp","string","setScreenshots","data","screenshots","concat","setStream","componentDidMount","listDevices","render","fromServer","el","signal","showAlert","clearTimeout","setTimeout"],"mappings":"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","sourcesContent":["import './InferenceUI.css';\nimport {Container, Row,Col\n    } from 'reactstrap';\nimport React from 'react';\n//import io from 'socket.io-client';\nimport WebcamStream from './WebcamStream.js'\nimport Screenshots from './Screenshots.js'\nimport Diagnosis from './Diagnosis.js'\nimport ElementsMain from './ElementsMain.js'\nimport manageStates from './functions/stateManager.js'\n\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\n\nclass InferenceUI extends React.Component {\n    constructor(props){\n      super();\n      this.state = {\n        stateName: \"Idle\",\n\n        // Render canvas or video\n        renderCanvas: true,\n        // Canvas Message\n        canvasMessage: \"\",\n        canvasAlert: false,\n\n        // Progress Bar props\n        showProgressBar: false,\n        progress: 0,\n        // Show Spinner\n        showSpinner: false,\n        // Button state\n        textCtrlBtn: \"Empezar\",\n        enableCtrlBtn: false,\n        enableCaptureBtn: false,\n\n        // Side Panel\n        enableDownloadsTab: false,\n        enableDiagnosisTab: false,\n        enableConfigTab: true,\n        enableGalleryTab: false,\n        GallerySrc: []\n      }\n\t\t\tthis.childScreenshots = React.createRef();\n\t\t\tthis.childWebcamStream = React.createRef();\n\t\t\tthis.childElementsMain = React.createRef();\n\t\t\tthis.childDiagnosis = React.createRef();\n\t\t\tthis.countdownFrom = 1;\n      this.alertTimeout = null;\n      this.videoThumbnail = null;\n    }\n\n\t\tasync handler(nextState){\n\t\t\tawait this.setState({stateName: nextState});\n\t\t  console.log(\"estado en switch: \" + this.state.stateName);\n      await this.setState(manageStates(this.state.stateName));\n\t\t}\n\n\t\tcaptureScreenshot(){\n\t\t\tthis.childScreenshots.current.captureScreenshot();\n\t\t}\n    mirrorPreview(){\n      this.childWebcamStream.current.mirror();\n    }\n    changeProgress(val){\n      this.setState({progress: val});\n    }\n    openNMAlert(){\n      this.childElementsMain.current.setState({openNMAlert: true}); \n//      this.childElementsMain.current.stopFunction(); \n    }\n    async startRecording(){\n      this.childWebcamStream.current.startRecording(); \n    }\n    async stopRecording(){\n      await this.childWebcamStream.current.stopRecording(); \n    }\n    getVideoThumbnail(img){\n      this.videoThumbnail = img;\n    }\n    getScreenshots(){\n      return this.childScreenshots.current.getScreenshots();\n    }\n    downloadHandler(media){\n      if(media.localeCompare(\"video\")===0){\n        this.childWebcamStream.current.downloadVideo();\n    }\n    else if(media.localeCompare(\"screenshots\")===0){\n      console.log(\"in\");\n      this.childScreenshots.current.download();\n    }\n  }\n  changeStateProp(string){\n    this.setState(string);\n  }\n\n  setScreenshots(data){\n    this.setState({screenshots: this.state.screenshots.concat(data)});\n  }\n  setStream(){\n    this.childWebcamStream.current.setStream(); \n  }\n  componentDidMount(){\n    this.childDiagnosis.listDevices();\n  }\n  render() {\n      return (\n\t\t\t\t\t<Container id=\"container\">\n            <Row>\n              <Col xs=\"12\" md=\"8\">\n                <WebcamStream currentState={this.state} \n                              handler={(nextState)=>this.handler(nextState)} \n                              changeStateProp={(string)=>this.changeStateProp(string)}\n                              countdownFrom={this.countdownFrom} \n                              ref={this.childWebcamStream}\n                              getVideoThumbnail={(img)=>this.getVideoThumbnail(img)}/>\n              </Col>\n              <Col xs=\"12\" md=\"4\">\n                <Diagnosis currentState={this.state}\n                              thumbnail={this.videoThumbnail}\n                              getScreenshots={()=>this.getScreenshots()}\n                              downloadHandler={(media)=>this.downloadHandler(media)}\n                              setStreamFromConfig={()=>this.setStream()}\n                              ref={this.childDiagnosis}\n                              />\n\n\n              </Col>\n            </Row>\n          </Container>\n\t\n        );\n        \n    }\n}\nfunction fromServer(el,signal,val){ //element, signal and valuue if necessary\n  if(signal.localeCompare(\"blur\") === 0){\n    if(el.state.showAlert){\n      clearTimeout(el.alertTimeout);\n      el.alertTimeout = setTimeout(function(){el.setState({canvasMessage: false})},5000)\n    }\n    else{\n      el.setState({canvasMessage: true});\n      el.alertTimeout = setTimeout(function(){el.setState({canvasMessage: false})},5000)\n    }\n  }\n  else if(signal.localeCompare(\"progress\") === 0){\n    el.changeProgress(val);\n  }\n  \n  else if(signal.localeCompare(\"NM\") === 0){\n    el.openNMAlert();\n  }\n\n}\nexport default InferenceUI;\n"]},"metadata":{},"sourceType":"module"}