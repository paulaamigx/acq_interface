{"ast":null,"code":"var _jsxFileName = \"/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js\";\nimport './InferenceUI.css';\nimport { Container } from 'reactstrap';\n/* Container, Col, Row,\n Form, FormGroup, Label, Input,\n Card, CardImg, CardBody, CardTitle, CardText } from 'reactstrap';*/\n\nimport React, { useRef, useEffect } from 'react'; //import io from 'socket.io-client';\n\nclass WebcamStream extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isVideoLoading: true\n    };\n    this.videoTag = React.createRef();\n    this.canvasPreview = React.createRef();\n    this.selectVideoSrc = React.createRef();\n    this.tick = this.tick.bind(this);\n  }\n\n  gotDevices(deviceInfos) {\n    this.selectVideoSrc.width = \"450\";\n\n    for (let i = 0; i !== deviceInfos.length; ++i) {\n      const deviceInfo = deviceInfos[i];\n      const option = document.createElement('option');\n      option.value = deviceInfo.deviceId;\n\n      if (deviceInfo.kind === 'videoinput') {\n        option.text = deviceInfo.label || 'camera ' + (this.selectVideoSrc.length + 1);\n        this.selectVideoSrc.appendChild(option);\n      }\n    }\n  }\n\n  getStream() {\n    if (window.stream) {\n      window.stream.getTracks().forEach(function (track) {\n        track.stop();\n        console.log(\"mmmmm\");\n      });\n    }\n\n    const constraints = {\n      video: {\n        deviceId: {\n          exact: this.selectVideoSrc.value\n        },\n        width: {\n          ideal: 1280\n        },\n        height: {\n          ideal: 720\n        }\n      }\n    };\n    navigator.mediaDevices.getUserMedia(constraints).then(stream => {\n      this.videoTag.current.srcObject = stream;\n      requestAnimationFrame(this.tick);\n      window.stream = stream;\n    });\n  }\n\n  componentDidMount() {\n    navigator.mediaDevices //      .getUserMedia({ video: { facingMode: \"environment\" } })\n    .enumerateDevices().then(this.gotDevices);\n  }\n\n  tick() {\n    const video = this.videoTag.current;\n    const checkVideoState = setInterval(() => {\n      if (video.readyState === video.HAVE_ENOUGH_DATA) {\n        clearInterval(checkVideoState);\n        this.setState({\n          isVideoLoading: false\n        });\n        const canvasPreviewElement = this.canvasPreview.current;\n        const canvasPreview = canvasPreviewElement.getContext(\"2d\");\n        canvasPreviewElement.height = video.videoHeight;\n        canvasPreviewElement.width = video.videoWidth;\n        canvasPreview.drawImage(video, 0, 0, canvasPreviewElement.width, canvasPreviewElement.height);\n        requestAnimationFrame(this.tick);\n      }\n    }, 50);\n  }\n\n  render() {\n    const {\n      isVideoLoading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.videoTag,\n      width: \"400\",\n      height: \"400\",\n      autoPlay: true,\n      style: {\n        display: \"none\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }), !isVideoLoading && /*#__PURE__*/React.createElement(\"canvas\", {\n      ref: this.canvasPreview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 29\n      }\n    }), isVideoLoading && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 28\n      }\n    }, \"Please wait while we load the video stream.\"), /*#__PURE__*/React.createElement(\"select\", {\n      ref: this.selectVideoSrc,\n      style: {\n        width: 300\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 5\n      }\n    }));\n  }\n\n}\n\nclass InferenceUI extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      id: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(WebcamStream, {\n      id: \"asa\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }\n    }));\n  }\n\n}\n\nexport default InferenceUI;","map":{"version":3,"sources":["/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js"],"names":["Container","React","useRef","useEffect","WebcamStream","Component","constructor","props","state","isVideoLoading","videoTag","createRef","canvasPreview","selectVideoSrc","tick","bind","gotDevices","deviceInfos","width","i","length","deviceInfo","option","document","createElement","value","deviceId","kind","text","label","appendChild","getStream","window","stream","getTracks","forEach","track","stop","console","log","constraints","video","exact","ideal","height","navigator","mediaDevices","getUserMedia","then","current","srcObject","requestAnimationFrame","componentDidMount","enumerateDevices","checkVideoState","setInterval","readyState","HAVE_ENOUGH_DATA","clearInterval","setState","canvasPreviewElement","getContext","videoHeight","videoWidth","drawImage","render","display","InferenceUI"],"mappings":"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","sourcesContent":["import './InferenceUI.css';\nimport {Container\n    } from 'reactstrap';\n   /* Container, Col, Row,\n    Form, FormGroup, Label, Input,\n    Card, CardImg, CardBody, CardTitle, CardText } from 'reactstrap';*/\nimport React, {useRef, useEffect} from 'react';\n//import io from 'socket.io-client';\n\nclass WebcamStream extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isVideoLoading: true\n    };\n\n    this.videoTag = React.createRef();\n    this.canvasPreview = React.createRef();\n\t\tthis.selectVideoSrc = React.createRef();\n    this.tick = this.tick.bind(this);\n  }\n\n  gotDevices(deviceInfos) {\n\t\tthis.selectVideoSrc.width = \"450\";\n  \tfor (let i = 0; i !== deviceInfos.length; ++i) {\n    \tconst deviceInfo = deviceInfos[i];\n    \tconst option = document.createElement('option');\n    \toption.value = deviceInfo.deviceId;\n    \tif (deviceInfo.kind === 'videoinput') {\n      \toption.text = deviceInfo.label || 'camera ' +\n        \t(this.selectVideoSrc.length + 1);\n      \tthis.selectVideoSrc.appendChild(option);\n    \t} \n \t\t}\n\t}\n\tgetStream() {\n\t\tif (window.stream) {\n\t\t\twindow.stream.getTracks().forEach(function(track) {\n\t\t\t\ttrack.stop();\n\t\t\t\tconsole.log(\"mmmmm\");\n\t\t\t});\n\t\t}\n\t\tconst constraints = {\n\t\t\tvideo: {\n\t\t\t\tdeviceId: {exact: this.selectVideoSrc.value},\n\t\t\t\twidth: {ideal: 1280},\n\t\t\t\theight: {ideal: 720}\n\t\t\t}\n\t\t};\n\t\tnavigator.mediaDevices.getUserMedia(constraints)\n    .then(stream => {\n        this.videoTag.current.srcObject = stream;\n        requestAnimationFrame(this.tick);\n        window.stream = stream;\n      });\n\t}\n\n  componentDidMount() {\n    navigator.mediaDevices\n//      .getUserMedia({ video: { facingMode: \"environment\" } })\n\t\t\t.enumerateDevices().then(this.gotDevices)\n  }\n\n\n  tick() {\n    const video = this.videoTag.current;\n\n    const checkVideoState = setInterval(() => {\n      if (video.readyState === video.HAVE_ENOUGH_DATA) {\n        clearInterval(checkVideoState);\n\n        this.setState({ isVideoLoading: false });\n\n          const canvasPreviewElement = this.canvasPreview.current;\n          const canvasPreview = canvasPreviewElement.getContext(\"2d\");\n\n          canvasPreviewElement.height = video.videoHeight;\n          canvasPreviewElement.width = video.videoWidth;\n          canvasPreview.drawImage(\n            video,\n            0,\n            0,\n            canvasPreviewElement.width,\n            canvasPreviewElement.height\n          );\n        requestAnimationFrame(this.tick);\n      }\n    }, 50);\n  }\n\n  render() {\n    const { isVideoLoading } = this.state;\n\n    return (\n      <div>\n        <video\n          ref={this.videoTag}\n          width=\"400\"\n          height=\"400\"\n          autoPlay\n          style={{ display: \"none\" }}\n        />\n\n        {!isVideoLoading && <canvas ref={this.canvasPreview} />}\n\n        {isVideoLoading && <p>Please wait while we load the video stream.</p>}\n\t\t\t\t<select ref={this.selectVideoSrc}\n\t\t\t\t\t\t\t\tstyle={{width: 300}}\n\t\t\t\t/>\n\n      </div>\n    );\n  }\n}\nclass InferenceUI extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n\n        }\n    }\n    \n\n    render() {\n      return (\n\t\t\t\t\t<Container id=\"container\">\n\t\t\t\t\t\t<WebcamStream id=\"asa\"/>\n\t\t\t\t\t</Container>\n        );\n        \n    }\n}\n\nexport default InferenceUI;\n"]},"metadata":{},"sourceType":"module"}