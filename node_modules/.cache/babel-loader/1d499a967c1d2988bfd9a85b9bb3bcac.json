{"ast":null,"code":"var _jsxFileName = \"/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js\";\nimport './InferenceUI.css';\nimport { Container } from 'reactstrap';\n/* Container, Col, Row,\n Form, FormGroup, Label, Input,\n Card, CardImg, CardBody, CardTitle, CardText } from 'reactstrap';*/\n\nimport React, { useRef, useEffect } from 'react';\nimport io from 'socket.io-client';\nimport jsQR from \"jsqr\";\n/*\nconst Canvas = props => {\n  const canvasRef = useRef(null)\n  useEffect(() => {\n    const canvas = canvasRef.current\n    const context = canvas.getContext('2d')\n\n\t\tcanvas.width = 640;\n\t\tcanvas.height= 480;\n\t\tcontext.width= 640;\n\t\tcontext.height= 480;\n\n    context.fillStyle = '#000000'\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height)\n\t\n\t\tvar video = document.querySelector(\"#asa\")\n\t\tconsole.log(\"aa\");\n\t\tconsole.log(video);\n\t\t\n\t\tconst render = () => {\n\t\tcontext.drawImage(video,0,0,context.width,context.height);\n\n\t\t}\n\t\trender()\n\t\treturn() => {\n\n\t\t}\n  }, [])\n\n\t\t\t\t\n\n  return <canvas ref={canvasRef} {...props}/>\n}\n*/\n\n/*\nclass WebcamStream extends React.Component {\n    constructor(props) {\n        super(props);\n        this.videoTag = React.createRef()\n\t\t\t\tthis.id = \"\"\n    }\n\n    componentDidMount() {\n       navigator.mediaDevices\n            .getUserMedia({video: true})\n            .then(stream => this.videoTag.current.srcObject = stream)\n            .catch(console.log);\n    }\n\n    render() {\n        return <video id={this.props.id}\n                      ref={this.videoTag}\n                      width={this.props.width}\n                      height={this.props.height}\n                      autoPlay\n                      title={this.props.title}></video>\n    }\n}\n*/\n\nclass WebcamStream extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isVideoLoading: true\n    };\n    this.videoTag = React.createRef();\n    this.canvas = React.createRef();\n    this.tick = this.tick.bind(this);\n  }\n\n  componentDidMount() {\n    // getting access to webcam\n    navigator.mediaDevices.getUserMedia({\n      video: {\n        facingMode: \"environment\"\n      }\n    }).then(stream => {\n      const video = this.videoTag.current;\n      video.srcObject = stream;\n      video.setAttribute(\"playsinline\", true);\n      video.play();\n      requestAnimationFrame(this.tick);\n    });\n  }\n\n  drawLine(begin, end, color) {\n    const canvasElement = this.canvas.current;\n    const canvas = canvasElement.getContext(\"2d\");\n    canvas.beginPath();\n    canvas.moveTo(begin.x, begin.y);\n    canvas.lineTo(end.x, end.y);\n    canvas.lineWidth = 4;\n    canvas.strokeStyle = color;\n    canvas.stroke();\n  }\n\n  tick() {\n    const video = this.videoTag.current;\n    const checkVideoState = setInterval(() => {\n      if (video.readyState === video.HAVE_ENOUGH_DATA) {\n        clearInterval(checkVideoState);\n        this.setState({\n          isVideoLoading: false\n        });\n        const canvasElement = this.canvas.current;\n        const canvas = canvasElement.getContext(\"2d\");\n        canvasElement.height = video.videoHeight;\n        canvasElement.width = video.videoWidth;\n        canvas.drawImage(video, 0, 0, canvasElement.width, canvasElement.height);\n        let imageData = canvas.getImageData(0, 0, canvasElement.width, canvasElement.height);\n        var code = jsQR(imageData.data, imageData.width, imageData.height);\n\n        if (code) {\n          this.drawLine(code.location.topLeftCorner, code.location.topRightCorner, \"#FF3B58\");\n          this.drawLine(code.location.topRightCorner, code.location.bottomRightCorner, \"#FF3B58\");\n          this.drawLine(code.location.bottomRightCorner, code.location.bottomLeftCorner, \"#FF3B58\");\n          this.drawLine(code.location.bottomLeftCorner, code.location.topLeftCorner, \"#FF3B58\");\n        }\n\n        requestAnimationFrame(this.tick);\n      }\n    }, 1000);\n  }\n\n  render() {\n    const {\n      isVideoLoading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.videoTag,\n      width: \"400\",\n      height: \"400\",\n      autoPlay: true,\n      style: {\n        display: \"none\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }\n    }), !isVideoLoading && /*#__PURE__*/React.createElement(\"canvas\", {\n      ref: this.canvas,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 29\n      }\n    }), isVideoLoading && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 28\n      }\n    }, \"Please wait while we load the video stream.\"));\n  }\n\n}\n\nclass InferenceUI extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      id: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(WebcamStream, {\n      id: \"asa\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 7\n      }\n    }));\n  }\n\n}\n\nexport default InferenceUI;","map":{"version":3,"sources":["/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js"],"names":["Container","React","useRef","useEffect","io","jsQR","WebcamStream","Component","constructor","props","state","isVideoLoading","videoTag","createRef","canvas","tick","bind","componentDidMount","navigator","mediaDevices","getUserMedia","video","facingMode","then","stream","current","srcObject","setAttribute","play","requestAnimationFrame","drawLine","begin","end","color","canvasElement","getContext","beginPath","moveTo","x","y","lineTo","lineWidth","strokeStyle","stroke","checkVideoState","setInterval","readyState","HAVE_ENOUGH_DATA","clearInterval","setState","height","videoHeight","width","videoWidth","drawImage","imageData","getImageData","code","data","location","topLeftCorner","topRightCorner","bottomRightCorner","bottomLeftCorner","render","display","InferenceUI"],"mappings":"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","sourcesContent":["import './InferenceUI.css';\nimport {Container\n    } from 'reactstrap';\n   /* Container, Col, Row,\n    Form, FormGroup, Label, Input,\n    Card, CardImg, CardBody, CardTitle, CardText } from 'reactstrap';*/\nimport React, {useRef, useEffect} from 'react';\nimport io from 'socket.io-client';\nimport jsQR from \"jsqr\";\n/*\nconst Canvas = props => {\n  const canvasRef = useRef(null)\n  useEffect(() => {\n    const canvas = canvasRef.current\n    const context = canvas.getContext('2d')\n\n\t\tcanvas.width = 640;\n\t\tcanvas.height= 480;\n\t\tcontext.width= 640;\n\t\tcontext.height= 480;\n\n    context.fillStyle = '#000000'\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height)\n\t\n\t\tvar video = document.querySelector(\"#asa\")\n\t\tconsole.log(\"aa\");\n\t\tconsole.log(video);\n\t\t\n\t\tconst render = () => {\n\t\tcontext.drawImage(video,0,0,context.width,context.height);\n\n\t\t}\n\t\trender()\n\t\treturn() => {\n\n\t\t}\n  }, [])\n\n\t\t\t\t\n\n  return <canvas ref={canvasRef} {...props}/>\n}\n*/\n\n/*\nclass WebcamStream extends React.Component {\n    constructor(props) {\n        super(props);\n        this.videoTag = React.createRef()\n\t\t\t\tthis.id = \"\"\n    }\n\n    componentDidMount() {\n       navigator.mediaDevices\n            .getUserMedia({video: true})\n            .then(stream => this.videoTag.current.srcObject = stream)\n            .catch(console.log);\n    }\n\n    render() {\n        return <video id={this.props.id}\n                      ref={this.videoTag}\n                      width={this.props.width}\n                      height={this.props.height}\n                      autoPlay\n                      title={this.props.title}></video>\n    }\n}\n*/\nclass WebcamStream extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isVideoLoading: true\n    };\n\n    this.videoTag = React.createRef();\n    this.canvas = React.createRef();\n\n    this.tick = this.tick.bind(this);\n  }\n\n  componentDidMount() {\n    // getting access to webcam\n    navigator.mediaDevices\n      .getUserMedia({ video: { facingMode: \"environment\" } })\n      .then(stream => {\n        const video = this.videoTag.current;\n        video.srcObject = stream;\n        video.setAttribute(\"playsinline\", true);\n        video.play();\n        requestAnimationFrame(this.tick);\n      });\n  }\n\n  drawLine(begin, end, color) {\n    const canvasElement = this.canvas.current;\n    const canvas = canvasElement.getContext(\"2d\");\n\n    canvas.beginPath();\n    canvas.moveTo(begin.x, begin.y);\n    canvas.lineTo(end.x, end.y);\n    canvas.lineWidth = 4;\n    canvas.strokeStyle = color;\n    canvas.stroke();\n  }\n\n  tick() {\n    const video = this.videoTag.current;\n\n    const checkVideoState = setInterval(() => {\n      if (video.readyState === video.HAVE_ENOUGH_DATA) {\n        clearInterval(checkVideoState);\n\n        this.setState({ isVideoLoading: false });\n\n          const canvasElement = this.canvas.current;\n          const canvas = canvasElement.getContext(\"2d\");\n\n          canvasElement.height = video.videoHeight;\n          canvasElement.width = video.videoWidth;\n          canvas.drawImage(\n            video,\n            0,\n            0,\n            canvasElement.width,\n            canvasElement.height\n          );\n          let imageData = canvas.getImageData(\n            0,\n            0,\n            canvasElement.width,\n            canvasElement.height\n          );\n\n          var code = jsQR(imageData.data, imageData.width, imageData.height);\n\n          if (code) {\n            this.drawLine(\n              code.location.topLeftCorner,\n              code.location.topRightCorner,\n              \"#FF3B58\"\n            );\n            this.drawLine(\n              code.location.topRightCorner,\n              code.location.bottomRightCorner,\n              \"#FF3B58\"\n            );\n            this.drawLine(\n              code.location.bottomRightCorner,\n              code.location.bottomLeftCorner,\n              \"#FF3B58\"\n            );\n            this.drawLine(\n              code.location.bottomLeftCorner,\n              code.location.topLeftCorner,\n              \"#FF3B58\"\n            );\n          } \n        requestAnimationFrame(this.tick);\n      }\n    }, 1000);\n  }\n\n  render() {\n    const { isVideoLoading } = this.state;\n\n    return (\n      <div>\n        <video\n          ref={this.videoTag}\n          width=\"400\"\n          height=\"400\"\n          autoPlay\n          style={{ display: \"none\" }}\n        />\n\n        {!isVideoLoading && <canvas ref={this.canvas} />}\n\n        {isVideoLoading && <p>Please wait while we load the video stream.</p>}\n      </div>\n    );\n  }\n}\nclass InferenceUI extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n\n        }\n    }\n\t\n    render() {\n        return (\n\t\t\t\t\t<Container id=\"container\">\n\t\t\t\t\t\t<WebcamStream id=\"asa\"/>\n\t\t\t\t\t</Container>\n        );\n        \n    }\n}\n\nexport default InferenceUI;\n"]},"metadata":{},"sourceType":"module"}