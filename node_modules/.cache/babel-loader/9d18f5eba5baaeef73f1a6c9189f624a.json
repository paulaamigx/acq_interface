{"ast":null,"code":"var _jsxFileName = \"/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js\";\nimport './InferenceUI.css';\nimport { Container, Button, Modal, ModalHeader, ModalBody, ModalFooter, Progress, Spinner } from 'reactstrap';\nimport React, { useState } from 'react'; //import io from 'socket.io-client';\n\nimport WebcamStream from './WebcamStream.js';\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\n\nvar Carousel = require('react-responsive-carousel').Carousel;\n\nconst ModalDiagnosis = props => {\n  const {\n    className\n  } = props;\n  const [modal, setModal] = useState(true);\n\n  const toggle = () => {\n    setModal(!modal);\n    props.handlerSuper();\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    isOpen: modal,\n    toggle: toggle,\n    className: className,\n    size: 'xl',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: toggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 9\n    }\n  }, \"Modal title\"), /*#__PURE__*/React.createElement(ModalBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Spinner, {\n    color: \"info\",\n    style: {\n      position: 'absolute',\n      margin: 'auto'\n    },\n    size: 'xl',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 6\n    }\n  }))));\n};\n\nconst ModalScreenshots = props => {\n  const {\n    className,\n    data\n  } = props;\n  const [modal, setModal] = useState(true);\n\n  const toggle = () => {\n    setModal(!modal);\n    props.handler();\n  };\n\n  console.log(\"as\");\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    isOpen: modal,\n    toggle: toggle,\n    className: className,\n    size: 'xl',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: toggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, \"Modal title\"), /*#__PURE__*/React.createElement(ModalBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Carousel, {\n    showArrows: true,\n    selectedItem: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }\n  }, data.map(slide => /*#__PURE__*/React.createElement(\"div\", {\n    key: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"slick-slide-image\",\n    src: slide.src,\n    alt: \"Error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 15\n    }\n  }))))), /*#__PURE__*/React.createElement(ModalFooter, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  })));\n};\n\nclass Screenshots extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.captureScreenshot = async () => {\n      var canvas = document.querySelector(\"#canvasPreview\");\n      var imgAsDataURL = canvas.toDataURL(\"image/jpeg\", 1);\n      let newSlidesData = [{\n        src: imgAsDataURL\n      }];\n      this.setState({\n        slidesData: this.state.slidesData.concat(newSlidesData)\n      });\n      await this.setState({\n        lastScreenshotID: this.state.lastScreenshotID + 1\n      });\n      let thumbs = document.getElementsByClassName(\"thumb\");\n\n      thumbs[thumbs.length - 1].onclick = async () => {\n        if (this.props.currentState.showModalScreenshots) {\n          this.setState({\n            modalOn: true\n          });\n        }\n      };\n\n      let btnsCarousel = document.getElementsByClassName(\"control-arrow\");\n\n      try {\n        btnsCarousel[2].style.backgroundColor = 'black';\n        btnsCarousel[3].style.backgroundColor = 'black';\n      } catch {}\n\n      document.querySelector(\".carousel-slider\").style.display = 'none';\n    };\n\n    this.state = {\n      lastScreenshotID: 0,\n      modalOn: false,\n      slidesData: []\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 4\n      }\n    }, this.state.modalOn && /*#__PURE__*/React.createElement(ModalScreenshots, {\n      handler: () => {\n        this.setState({\n          modalOn: false\n        });\n      },\n      data: this.state.slidesData,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 28\n      }\n    }), /*#__PURE__*/React.createElement(Carousel, {\n      showArrows: true,\n      selectedItem: this.state.lastScreenshotID,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }\n    }, this.state.slidesData.map(slide => /*#__PURE__*/React.createElement(\"div\", {\n      key: this.state.lastScreenshotID,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"slick-slide-image\",\n      src: slide.src,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 15\n      }\n    })))));\n  }\n\n}\n\nfunction startStopFunction(btn) {\n  if (btn.props.currentState.textMainBtn.localeCompare(\"Start\") === 0) {\n    btn.props.handler(\"Countdown\");\n    startFunction(btn);\n    return;\n  }\n\n  btn.props.handler(\"StopStream\"); //stopFunction();\n}\n\nfunction startFunction(btn) {\n  btn.props.currentState.almostStreaming = true; //btn.props.timeStartPressed = Date.now();\n}\n\nclass Diagnosis extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 4\n      }\n    }, this.props.currentState.showModalDiagnosis && /*#__PURE__*/React.createElement(ModalDiagnosis, {\n      handlerSuper: () => {\n        this.props.handler(\"closeDiagnosis\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 52\n      }\n    }));\n  }\n\n}\n\nclass ComponentsMain extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 4\n      }\n    }, this.props.currentState.showStartBtn && /*#__PURE__*/React.createElement(Button, {\n      color: \"primary\",\n      onClick: () => startStopFunction(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 45\n      }\n    }, this.props.currentState.textMainBtn), this.props.currentState.showCaptureBtn && /*#__PURE__*/React.createElement(Button, {\n      color: \"primary\",\n      disabled: this.props.currentState.disableBtnCapture,\n      onClick: () => this.props.captureScreenshot(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 47\n      }\n    }, \"Capture Screenshot\"), this.props.currentState.showProgressBar && /*#__PURE__*/React.createElement(Progress, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 48\n      }\n    }));\n  }\n\n}\n\nfunction manageStates(state) {\n  var flags = {};\n\n  switch (state) {\n    case 'OnConnection':\n      flags = {\n        textMainBtn: \"Start\",\n        showStartBtn: true,\n        showCaptureBtn: true,\n        showVideoSelect: false,\n        showProgressBar: false,\n        showModalScreenshots: true,\n        //if requested\n        showModalDiagnosis: false,\n        disableBtnCapture: false,\n        streaming: false,\n        almostStreaming: false\n      };\n      break;\n\n    case 'Countdown':\n      flags = {\n        textMainBtn: \"Stop\",\n        showStartBtn: true,\n        showCaptureBtn: true,\n        showVideoSelect: false,\n        showProgressBar: true,\n        showModalScreenshots: false,\n        //if requested\n        showModalDiagnosis: false,\n        disableBtnCapture: true,\n        streaming: false,\n        almostStreaming: true,\n        timeStartPressed: Date.now()\n      };\n      break;\n\n    case 'Streaming':\n      flags = {\n        textMainBtn: \"Stop\",\n        showStartBtn: true,\n        showCaptureBtn: true,\n        showVideoSelect: false,\n        showProgressBar: true,\n        showModalScreenshots: false,\n        //if requested\n        showModalDiagnosis: false,\n        disableBtnCapture: false,\n        streaming: true,\n        almostStreaming: false\n      };\n      break;\n\n    case 'StopStream':\n      flags = {\n        textMainBtn: \"Start\",\n        showStartBtn: true,\n        showCaptureBtn: true,\n        showVideoSelect: false,\n        showProgressBar: true,\n        showModalScreenshots: false,\n        //if requested\n        showModalDiagnosis: false,\n        disableBtnCapture: true,\n        streaming: false,\n        almostStreaming: true\n      };\n      break;\n\n    case 'closeDiagnosis':\n      flags = {\n        showModalDiagnosis: false\n      };\n      break;\n\n    default:\n      console.log('State not defined');\n  }\n\n  return flags;\n}\n\nclass InferenceUI extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      current: \"SelectingSource\",\n      textMainBtn: \"Start\",\n      showStartBtn: false,\n      showCaptureBtn: false,\n      showVideoSelect: false,\n      showProgressBar: false,\n      showModalScreenshots: false,\n      //if requested\n      showModalDiagnosis: false,\n      disableBtnCapture: false,\n      streaming: false,\n      almostStreaming: false,\n      timeStartPressed: 0,\n      triggerCaptureScreenshot: false\n    };\n    this.child = React.createRef();\n    this.countdownFrom = 1;\n  }\n\n  async handler(nextState) {\n    await this.setState({\n      current: nextState\n    });\n    console.log(\"estado en switch: \" + this.state.current);\n    await this.setState(manageStates(this.state.current));\n  }\n\n  captureScreenshot() {\n    this.child.current.captureScreenshot();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      id: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(WebcamStream, {\n      id: \"WebcamStream\",\n      currentState: this.state,\n      handler: nextState => this.handler(nextState),\n      countdownFrom: this.countdownFrom,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(ComponentsMain, {\n      currentState: this.state,\n      handler: nextState => this.handler(nextState),\n      captureScreenshot: () => this.captureScreenshot(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(Screenshots, {\n      currentState: this.state,\n      handler: nextState => this.handler(nextState),\n      ref: this.child,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(Diagnosis, {\n      currentState: this.state,\n      handler: nextState => this.handler(nextState),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 7\n      }\n    }));\n  }\n\n}\n\nexport default InferenceUI;","map":{"version":3,"sources":["/home/paula/Documents/Practica/git/user_interface/src/components/InferenceUI/InferenceUI.js"],"names":["Container","Button","Modal","ModalHeader","ModalBody","ModalFooter","Progress","Spinner","React","useState","WebcamStream","Carousel","require","ModalDiagnosis","props","className","modal","setModal","toggle","handlerSuper","position","margin","ModalScreenshots","data","handler","console","log","map","slide","src","Screenshots","Component","constructor","captureScreenshot","canvas","document","querySelector","imgAsDataURL","toDataURL","newSlidesData","setState","slidesData","state","concat","lastScreenshotID","thumbs","getElementsByClassName","length","onclick","currentState","showModalScreenshots","modalOn","btnsCarousel","style","backgroundColor","display","render","startStopFunction","btn","textMainBtn","localeCompare","startFunction","almostStreaming","Diagnosis","showModalDiagnosis","ComponentsMain","showStartBtn","showCaptureBtn","disableBtnCapture","showProgressBar","manageStates","flags","showVideoSelect","streaming","timeStartPressed","Date","now","InferenceUI","current","triggerCaptureScreenshot","child","createRef","countdownFrom","nextState"],"mappings":"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","sourcesContent":["import './InferenceUI.css';\nimport {Container, Button, Modal, ModalHeader, ModalBody, ModalFooter, Progress, Spinner\n    } from 'reactstrap';\nimport React, {useState}from 'react';\n//import io from 'socket.io-client';\nimport WebcamStream from './WebcamStream.js'\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\n\n\n\n\nvar Carousel = require('react-responsive-carousel').Carousel;\nconst ModalDiagnosis= (props) => {\n  const {\n    className\n  } = props;\n\n  const [modal, setModal] = useState(true);\n\n  const toggle = () => {\n  \tsetModal(!modal);\n\t\tprops.handlerSuper();\n\t}\n  return (\n    <div>\n      <Modal isOpen={modal} toggle={toggle} className={className} size={'xl'}>\n        <ModalHeader toggle={toggle}>Modal title</ModalHeader>\n        <ModalBody>\n\t\t\t\t\t<Spinner color=\"info\" style={{ position: 'absolute',margin: 'auto' }} size={'xl'}/>\n        </ModalBody>\n      </Modal>\n    </div>\n  );\n}\n\nconst ModalScreenshots = (props) => {\n  const {\n    className,\n    data,\t\n  } = props;\n  const [modal, setModal] = useState(true);\n\n  const toggle = () => {\n    setModal(!modal); \n\t\tprops.handler();\n  }\n  console.log(\"as\");\n  return (\n    <div>\n      <Modal isOpen={modal} toggle={toggle} className={className} size={'xl'}>\n        <ModalHeader toggle={toggle}>Modal title</ModalHeader>\n        <ModalBody>\n        <Carousel showArrows={true} selectedItem={0} >\n          {data.map((slide) =>\n            <div key={0}>\n              <img className=\"slick-slide-image\" src={slide.src} alt='Error' />\n            </div>\n          )}\n        </Carousel>\n        </ModalBody>\n        <ModalFooter>\n        </ModalFooter>\n      </Modal>\n    </div>\n  );\n}\nclass Screenshots extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {\n      lastScreenshotID: 0,\n      modalOn: false,\n      slidesData: []\n    };\n  }\n\n\tcaptureScreenshot = async () => {\n  \tvar canvas = document.querySelector(\"#canvasPreview\");\n\t\tvar imgAsDataURL = canvas.toDataURL(\"image/jpeg\",1);\n    \n    let newSlidesData = [{src: imgAsDataURL}];\n\t\tthis.setState({slidesData: this.state.slidesData.concat(newSlidesData)});\n\t\tawait this.setState({lastScreenshotID: this.state.lastScreenshotID+1});\n\t\t\n\t  let thumbs = document.getElementsByClassName(\"thumb\");\n\t\tthumbs[thumbs.length-1].onclick = async() => {\n\t\t\tif(this.props.currentState.showModalScreenshots){\n        this.setState({modalOn: true});\n\t\t\t}\n\t\t};\t\n\n    let btnsCarousel = document.getElementsByClassName(\"control-arrow\");\n\t\ttry{\n\t\t\tbtnsCarousel[2].style.backgroundColor= 'black';\n\t\t\tbtnsCarousel[3].style.backgroundColor= 'black';\n\t\t}\n\t\tcatch{\n\t\t\n\t\t}\n\t\tdocument.querySelector(\".carousel-slider\").style.display = 'none';\n\n}\n\trender(){\n    return(\n\t\t\t<div>\n\t\t\t\t{this.state.modalOn && <ModalScreenshots handler={()=>{this.setState({modalOn:false})}} data={this.state.slidesData}/>}\n        <Carousel showArrows={true} selectedItem={this.state.lastScreenshotID} >\n          {this.state.slidesData.map((slide) =>\n            <div key={this.state.lastScreenshotID}>\n              <img className=\"slick-slide-image\" src={slide.src} alt='' />\n            </div>\n          )}\n        </Carousel>\n\t\t\t</div>\n    );\n\t}\n\n}\nfunction startStopFunction(btn){\n  if (btn.props.currentState.textMainBtn.localeCompare(\"Start\") === 0){\n\t\tbtn.props.handler(\"Countdown\");\n    startFunction(btn);\n    return;\n  }\n\tbtn.props.handler(\"StopStream\");\n  //stopFunction();\n}\nfunction startFunction(btn){\n\t\n\tbtn.props.currentState.almostStreaming = true;\n  //btn.props.timeStartPressed = Date.now();\n\n}\nclass Diagnosis extends React.Component{\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t}\n\t\t\n\t}\n\n\trender(){\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t{this.props.currentState.showModalDiagnosis && <ModalDiagnosis handlerSuper={()=>{this.props.handler(\"closeDiagnosis\")}}/>}\n\t\t\t</div>\n\t\t);\n\t}\n}\nclass ComponentsMain extends React.Component{\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t}\n\t}\n  \n\n\trender(){\n\t\treturn(\n\t\t\t<div>\n\t\t\t{this.props.currentState.showStartBtn && <Button color=\"primary\" onClick={() => startStopFunction(this)}>{this.props.currentState.textMainBtn}</Button>}\n\t\t\t{this.props.currentState.showCaptureBtn && <Button color=\"primary\" disabled={this.props.currentState.disableBtnCapture}  onClick={() => this.props.captureScreenshot()}>{\"Capture Screenshot\"}</Button>}\n\t\t\t{this.props.currentState.showProgressBar && <Progress/>}\n\t\t\t</div>\n\t\t);\n\t}\n}\nfunction manageStates(state){\n  var flags = {};\n  switch(state){\n  \tcase 'OnConnection':\n    \tflags={\n\t\t\t\ttextMainBtn: \"Start\",\n\t\t\t\tshowStartBtn: true,\n\t\t\t\tshowCaptureBtn: true,\n\t\t\t\tshowVideoSelect: false,\n\t\t\t\tshowProgressBar: false,\n\t\t\t\tshowModalScreenshots: true, //if requested\n\t\t\t\tshowModalDiagnosis: false,\n\t\t\t\tdisableBtnCapture: false,\n\n\t\t\t\tstreaming: false,\n\t\t\t\talmostStreaming: false,          \n\t\t\t};\n\t\t\tbreak;\n\t\tcase 'Countdown':\n\t\t\tflags={\n\t\t\t\ttextMainBtn: \"Stop\",\n\t\t\t\tshowStartBtn: true,\n\t\t\t\tshowCaptureBtn: true,\n\t\t\t\tshowVideoSelect: false,\n\t\t\t\tshowProgressBar: true,\n\t\t\t\tshowModalScreenshots: false, //if requested\n\t\t\t\tshowModalDiagnosis: false,\n\t\t\t\tdisableBtnCapture: true,\n\n\t\t\t\tstreaming: false,\n\t\t\t\talmostStreaming: true,          \n\t\t\t\t\n\t\t\t\ttimeStartPressed: Date.now()\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\tcase 'Streaming':\n\t\t\tflags={\n\t\t\t\ttextMainBtn: \"Stop\",\n\t\t\t\tshowStartBtn: true,\n\t\t\t\tshowCaptureBtn: true,\n\t\t\t\tshowVideoSelect: false,\n\t\t\t\tshowProgressBar: true,\n\t\t\t\tshowModalScreenshots: false, //if requested\n\t\t\t\tshowModalDiagnosis: false,\n\t\t\t\tdisableBtnCapture: false,\n\n\t\t\t\tstreaming: true,\n\t\t\t\talmostStreaming: false,          \n\n\t\t\t};\n\t\t\tbreak;\n\t\tcase 'StopStream':\n\t\t\tflags={\n\t\t\t\ttextMainBtn: \"Start\",\n\t\t\t\tshowStartBtn: true,\n\t\t\t\tshowCaptureBtn: true,\n\t\t\t\tshowVideoSelect: false,\n\t\t\t\tshowProgressBar: true,\n\t\t\t\tshowModalScreenshots: false, //if requested\n\t\t\t\tshowModalDiagnosis: false,\n\t\t\t\tdisableBtnCapture: true,\n\n\t\t\t\tstreaming: false,\n\t\t\t\talmostStreaming: true,          \n\t\t\t};\n\t\t\tbreak;\n\t\tcase 'closeDiagnosis':\n\t\t\tflags={\n\t\t\t\tshowModalDiagnosis: false\n\t\t\t};\t\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconsole.log('State not defined');\n\n\t}\n  return flags;\n}\nclass InferenceUI extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n      \t\tcurrent: \"SelectingSource\",\n\n\t\t\t\t\ttextMainBtn: \"Start\",\n\t\t\t\t\tshowStartBtn: false,\n\t\t\t\t\tshowCaptureBtn: false,\n\t\t\t\t\tshowVideoSelect: false,\n\t\t\t\t\tshowProgressBar: false,\n\t\t\t\t\tshowModalScreenshots: false, //if requested\n\t\t\t\t\tshowModalDiagnosis: false,\n\t\t\t\t\tdisableBtnCapture: false,\n\n          streaming: false,\n          almostStreaming: false,          \n\n\t\t\t\t\ttimeStartPressed: 0,\n\n\t\t\t\t\ttriggerCaptureScreenshot: false\n        }\n\t\t\tthis.child = React.createRef();\n\t\t\tthis.countdownFrom = 1;\n    }\n\n\t\tasync handler(nextState){\n\t\t\tawait this.setState({current: nextState});\n\t\t  console.log(\"estado en switch: \" + this.state.current);\n      await this.setState(manageStates(this.state.current));\n\t\t}\n\n\t\tcaptureScreenshot(){\n\t\t\tthis.child.current.captureScreenshot();\n\t\t}\n    render() {\n      return (\n\t\t\t\t\t<Container id=\"container\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<WebcamStream id=\"WebcamStream\" currentState={this.state} handler={(nextState)=>this.handler(nextState)} countdownFrom={this.countdownFrom}/>\n\t\t\t\t\t\t<ComponentsMain currentState={this.state} handler={(nextState)=>this.handler(nextState)} captureScreenshot={()=>this.captureScreenshot()}/> \n\t\t\t\t\t\t<Screenshots currentState={this.state} handler={(nextState)=>this.handler(nextState)} ref={this.child} />\n\t\t\t\t\t\t<Diagnosis currentState={this.state} handler={(nextState)=>this.handler(nextState)}/>\n\t\t\t\t  </Container>\n\t\n        );\n        \n    }\n}\n\nexport default InferenceUI;\n"]},"metadata":{},"sourceType":"module"}